(()=>{"use strict";function e(e){return 20*e}function n(n){return{x:e(n.x),y:560-e(n.y)}}function i(i,t,l,o){var s=n(t);i.fillStyle="#000",i.fillRect(s.x,s.y,e(o),-e(l)),i.fillStyle="darkgreen",i.fillRect(s.x+1,s.y+1,e(o)-2,1-e(l))}var t=new Image;function l(e,i){var l=n(i);e.drawImage(t,l.x-31,l.y-46)}function o(e,n,i,t,l){var o=t*Math.PI/180;return{x:e+l*Math.cos(o)*i,y:n+l*Math.sin(o)*i-4.905*i*i}}t.src="donkey-kong.png";const s="AnDerReihe",r="Abgeworfen",a="Warten",u="Gewonnen";var d={spieler1:{name:"1",position:null,zustand:s,zeitAbgeworfen:null,winkel:void 0,geschwindigkeit:void 0},spieler2:{name:"2",position:null,zustand:a,zeitAbgeworfen:null,winkel:void 0,geschwindigkeit:void 0},ballPosition:null,haeuser:[]};function g(){return 20*Math.random()}function p(e,n){d.spieler1.zustand===s&&(d.spieler1.zeitAbgeworfen=new Date,d.spieler1.zustand=r,d.spieler1.winkel=e,d.spieler1.geschwindigkeit=n,d.ballPosition=d.spieler1.position)}function c(){return d.ballPosition.y<0||d.ballPosition.x>50||d.ballPosition.x<0}function h(){for(var e=0;e<d.haeuser.length;e++){var n=d.haeuser[e];if(d.ballPosition.x>n.x&&d.ballPosition.x<n.x+n.b&&n.y>d.ballPosition.y)return!0}return d.ballPosition.y<0}function y(e){var n=e.position.x-d.ballPosition.x,i=e.position.y-d.ballPosition.y;return Math.sqrt(n*n+i*i)<=1.5}function m(){var e=new Date;if(d.spieler1.zustand===r){var n=(e.getTime()-d.spieler1.zeitAbgeworfen.getTime())/1e3;d.ballPosition=o(d.spieler1.position.x,d.spieler1.position.y,n,d.spieler1.winkel,d.spieler1.geschwindigkeit),y(d.spieler2)?d.spieler1.zustand=u:(h()||c())&&(d.spieler1.zustand=a,d.spieler2.zustand=s)}return d.spieler2.zustand===r&&(n=(e.getTime()-d.spieler2.zeitAbgeworfen.getTime())/1e3,d.ballPosition=o(d.spieler2.position.x,d.spieler2.position.y,n,d.spieler2.winkel,d.spieler2.geschwindigkeit),y(d.spieler1)?d.spieler2.zustand=u:(h()||c())&&(d.spieler1.zustand=s,d.spieler2.zustand=a)),d}var f,w,b=null,x=null;window.onload=function(){var e=document.getElementById("Spielflaeche");(x=document.createElement("canvas")).width=e.width,x.height=e.height,b=x.getContext("2d"),document.getElementById("EingabeButon1").onclick=P,document.getElementById("EingabeButon2").onclick=B,console.log("adding eventhandler "),e.addEventListener("mousedown",k,!1),e.addEventListener("mousemove",I,!1),e.addEventListener("mouseup",E,!1),d.haeuser=[{x:0,y:g(),b:5},{x:5,y:g(),b:5},{x:10,y:g(),b:5},{x:15,y:g(),b:5},{x:20,y:g(),b:5},{x:25,y:g(),b:5},{x:30,y:g(),b:5},{x:35,y:g(),b:5},{x:40,y:g(),b:5},{x:45,y:g(),b:5}],d.spieler1.position={x:d.haeuser[1].x+3,y:d.haeuser[1].y},d.spieler2.position={x:d.haeuser[d.haeuser.length-2].x+3,y:d.haeuser[d.haeuser.length-2].y},d.ballPosition=null,document.getElementById("Spieler1Titel").innerHTML="Spieler 1 ist dran",M()};var v=void 0,z=void 0;function k(e){console.log(e),v={x:e.offsetX,y:e.offsetY},z=new Date}function I(e){}function E(e){console.log(e);var i,t={x:e.offsetX,y:e.offsetY},l=(i=z,((new Date).getTime()-i.getTime())/1e3);if(v){var o=function(e,n,i){var t=n.x-e.x,l=n.y-e.y,o=Math.sqrt(t*t+l*l);return{winkel:180*Math.acos(t/o)/Math.PI,geschwindigkeit:o/(1e3*i)}}(n(v),n(t),l);p(o.winkel,o.geschwindigkeit),v=null}}async function P(){f=parseInt(document.getElementById("EingabeWinkel1").value),w=parseInt(document.getElementById("EingabeGeschwindigkeit1").value),p(f,w)}async function B(){f=parseInt(document.getElementById("EingabeWinkel2").value),w=parseInt(document.getElementById("EingabeGeschwindigkeit2").value),function(e,n){d.spieler2.zustand===s&&(d.spieler2.zeitAbgeworfen=new Date,d.spieler2.zustand=r,d.spieler2.winkel=e,d.spieler2.geschwindigkeit=n,d.ballPosition=d.spieler2.position)}(180-f,w)}function T(e){e.zustand===u?document.getElementById("Info").innerHTML="Spieler"+e.name+" hat gewonnen.":e.zustand===s?document.getElementById("Spieler"+e.name+"Titel").innerHTML="Spieler "+e.name+" ist dran":e.zustand===r?document.getElementById("Spieler"+e.name+"Titel").innerHTML="Spieler "+e.name+" hat geworfen":e.zustand===a&&(document.getElementById("Spieler"+e.name+"Titel").innerHTML="Spieler "+e.name+" wartet")}function M(){var e=m();b.clearRect(0,0,x.width,x.height);var t,o,s=0;for(let n=0;n<e.haeuser.length;n++){const t=e.haeuser[n].y,l=e.haeuser[n].b;i(b,{x:s,y:0},t,l),s+=l}l(b,e.spieler1.position),l(b,e.spieler2.position),T(e.spieler1),T(e.spieler2),e.spieler1.zustand!==r&&e.spieler2.zustand!==r||function(e,i){var t=n(i);e.beginPath(),e.arc(t.x,t.y,10,0,2*Math.PI),e.fillStyle="red",e.fill()}(b,e.ballPosition),(o=(t=document.getElementById("Spielflaeche")).getContext("2d")).clearRect(0,0,t.width,t.height),o.drawImage(x,0,0),requestAnimationFrame(M)}})();